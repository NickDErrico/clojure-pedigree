# GENERATED BY ANSIBLE, DO NOT EDIT
# EDIT THE TEMPLATE IN ansible/templates/web/docker-compose.yml
websources:
  build: ./images/sources
  volumes:
    - {{ project_dir }}/site:/usr/src/app

neosources:
  build: ./images/sources
  volumes:
    - {{ project_dir }}/neo:/usr/src/app

server:
  build: ./images/server
  command: sh -c 'while true; do sleep 10000; done'
  volumes:
    - {{ cache_dir }}/.m2:/root/.m2
  volumes_from:
    - websources
  ports:
    - "{{ web_ring_host_port }}:{{ web_ring_port }}"
    - "{{ web_nrepl_host_port }}:{{ web_nrepl_port }}"
  links:
    - postgres
    - neo4j

postgres:
  build: ./images/postgres
  environment:
    POSTGRES_PASSWORD: {{ web_db_pass }}
    POSTGRES_DB: {{ web_db_name }}
  ports:
    - "{{ web_db_host_port }}:{{ web_db_port }}"

schemup:
  build: ./images/schemup
  command: sh -c 'while true; do sleep 10000; done'
  links:
    - postgres
  volumes:
    - ./schema:/schema
  working_dir: /schema

neo4j:
  build: ./images/neo4j
  ports:
    - "{{ web_neo4j_host_port }}:{{ web_neo4j_port }}"
  environment:
    NEO4J_AUTH: none

frontend:
  build: ./images/frontend
  volumes_from:
    - websources
  volumes:
    - {{ project_dir }}:/usr/src/root
  command: sh -c 'while true; do sleep 10000; done'

neonode:
  build: ./images/neonode
  command: sh -c 'while true; do sleep 10000; done'
  volumes_from:
    - neosources
