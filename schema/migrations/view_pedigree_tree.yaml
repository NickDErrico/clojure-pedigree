---
table: view_pedigree_tree
from: null
to: txt_1
depends:
  - ["view_pedigree_info", txt_1]
sql: |
  CREATE VIEW view_pedigree_tree AS
  WITH RECURSIVE nodes(
      parent_id,
      child_id,
      path) AS (

  SELECT
      p.parent_id,
      p.child_id,
      ARRAY[p.parent_id]
  FROM view_pedigree_info AS p

  UNION ALL

  SELECT
      p.parent_id,
      p.child_id,
      path || p.parent_id
  FROM view_pedigree_info AS p, nodes AS n
  WHERE p.parent_id = n.child_id
      )
  SELECT * FROM nodes;
